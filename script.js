const tilesData = [
    {
        "Name": "Oppenheimer",
        "Thumbnail src": "https://i3.ytimg.com/vi/XRejEcValfE/maxresdefault.jpg",
        "highlightlink": "https://www.youtube.com/watch?v=XRejEcValfE",
        "fullreactionlink": "https://www.patreon.com/posts/oppenheimer-full-93422871",
        "tags": "['oppenheimer', 'biopic', 'history']",
        "uploaddate": 1700606875000
    },
    {
        "Name": "Indiana Jones and the Temple of Doom",
        "Thumbnail src": "https://i3.ytimg.com/vi/1ekpphPfPnw/maxresdefault.jpg",
        "highlightlink": "https://youtu.be/1ekpphPfPnw",
        "fullreactionlink": "https://www.patreon.com/posts/indiana-jones-of-93311734",
        "tags": "['indiana jones and the temple of doom', 'adventure', 'action', 'classic']",
        "uploaddate": 1700347675000
    },
    {
        "Name": "The Running Man",
        "Thumbnail src": "http://i3.ytimg.com/vi/J47rgAO1dHc/maxresdefault.jpg",
        "highlightlink": "https://youtu.be/J47rgAO1dHc",
        "fullreactionlink": "https://www.patreon.com/posts/running-man-full-93024989",
        "tags": "['the running man', 'sci-fi', 'action', 'classic']",
        "uploaddate": 1700136000000
    },
    {
        "Name": "Star Wars Episode IV: A New hope",
        "Thumbnail src": "http://i3.ytimg.com/vi/5elCEoTZMI4/maxresdefault.jpg",
        "highlightlink": "https://youtu.be/5elCEoTZMI4",
        "fullreactionlink": "https://www.patreon.com/posts/star-wars-iv-new-68027921",
        "tags": "['star wars', 'sci-fi', 'fantasy', 'adventure', 'classic']",
        "uploaddate": 1655769600000
    },
    {
        "Name": "Iron Man",
        "Thumbnail src": "http://i3.ytimg.com/vi/arrogOKeLGw/maxresdefault.jpg",
        "highlightlink": "https://youtu.be/arrogOKeLGw",
        "fullreactionlink": "https://www.patreon.com/posts/iron-man-full-68028558",
        "tags": "['mcu', 'marvel', 'sci-fi', 'action', 'super hero']",
        "uploaddate": 1656288000000
    },
    {
        "Name": "Star Wars Episode V: Empire Strikes Back",
        "Thumbnail src": "http://i3.ytimg.com/vi/LB6hr72SeP0/maxresdefault.jpg",
        "highlightlink": "https://youtu.be/LB6hr72SeP0",
        "fullreactionlink": "https://www.patreon.com/posts/star-wars-v-back-68028765",
        "tags": "['star wars', 'sci-fi', 'fantasy', 'adventure', 'classic']",
        "uploaddate": 1656374400000
    },
    {
        "Name": "Top Gun",
        "Thumbnail src": "http://i3.ytimg.com/vi/w-Aio6atZD4/maxresdefault.jpg",
        "highlightlink": "https://youtu.be/w-Aio6atZD4",
        "fullreactionlink": "https://www.patreon.com/posts/top-gun-full-68529362",
        "tags": "['action', 'war', 'classic', 'bromance']",
        "uploaddate": 1656633600000
    },
    {
        "Name": "The Incredible Hulk",
        "Thumbnail src": "http://i3.ytimg.com/vi/Tp37FCWeDbg/maxresdefault.jpg",
        "highlightlink": "https://youtu.be/Tp37FCWeDbg",
        "fullreactionlink": "https://www.patreon.com/posts/incredible-hulk-68281586",
        "tags": "['mcu', 'marvel', 'sci-fi', 'action', 'super hero']",
        "uploaddate": 1656979200000
    },
    {
        "Name": "Star Wars Episode VI: Return of the Jedi",
        "Thumbnail src": "http://i3.ytimg.com/vi/JyvpdwbtAbA/maxresdefault.jpg",
        "highlightlink": "https://youtu.be/JyvpdwbtAbA",
        "fullreactionlink": "https://www.patreon.com/posts/star-wars-vi-of-68375907",
        "tags": "['star wars', 'sci-fi', 'fantasy', 'adventure', 'classic']",
        "uploaddate": 1657152000000
    },
    {
        "Name": "Iron Man 2",
        "Thumbnail src": "http://i3.ytimg.com/vi/teJP3J0ah7Y/maxresdefault.jpg",
        "highlightlink": "https://youtu.be/teJP3J0ah7Y",
        "fullreactionlink": "https://www.patreon.com/posts/iron-man-2-full-68696787",
        "tags": "['mcu', 'marvel', 'sci-fi', 'action', 'super hero']",
        "uploaddate": 1657670400000
    },
    {
        "Name": "Star Wars Episode I: The Phantom Menace",
        "Thumbnail src": "http://i3.ytimg.com/vi/rylPR7yznsc/maxresdefault.jpg",
        "highlightlink": "https://youtu.be/rylPR7yznsc",
        "fullreactionlink": "https://www.patreon.com/posts/star-wars-menace-68782974",
        "tags": "['star wars', 'sci-fi', 'fantasy', 'adventure']",
        "uploaddate": 1657843200000
    },
    {
        "Name": "Star Wars Episode II: Attack of the Clones",
        "Thumbnail src": "http://i3.ytimg.com/vi/fb7D61n1aKU/maxresdefault.jpg",
        "highlightlink": "https://youtu.be/fb7D61n1aKU",
        "fullreactionlink": "https://www.patreon.com/posts/star-wars-ii-of-69142131",
        "tags": "['star wars', 'sci-fi', 'fantasy', 'adventure']",
        "uploaddate": 1668038400000
    },
    {
        "Name": "Thor",
        "Thumbnail src": "http://i3.ytimg.com/vi/5QalC9RtnxA/maxresdefault.jpg",
        "highlightlink": "https://youtu.be/5QalC9RtnxA",
        "fullreactionlink": "https://www.patreon.com/posts/thor-full-69050822",
        "tags": "['mcu', 'marvel', 'fantasy', 'action', 'super hero']",
        "uploaddate": 1668297600000
    },
    {
        "Name": "Star Wars Episode III: Revenge of the Sith",
        "Thumbnail src": "http://i3.ytimg.com/vi/Pq38zpirVD4/maxresdefault.jpg",
        "highlightlink": "https://youtu.be/Pq38zpirVD4",
        "fullreactionlink": "https://www.patreon.com/posts/star-wars-of-74488358",
        "tags": "['star wars', 'sci-fi', 'fantasy', 'adventure']",
        "uploaddate": 1668556800000
    },
    {
        "Name": "Captain America: The First Avenger",
        "Thumbnail src": "http://i3.ytimg.com/vi/TVEfDZkCy18/maxresdefault.jpg",
        "highlightlink": "https://youtu.be/TVEfDZkCy18",
        "fullreactionlink": "https://www.patreon.com/posts/captain-america-69353726",
        "tags": "['mcu', 'marvel', 'sci-fi', 'action', 'super hero', 'period piece']",
        "uploaddate": 1668816000000
    },
    {
        "Name": "Star Wars Episode VII: The Force Awakens",
        "Thumbnail src": "http://i3.ytimg.com/vi/No6OF0jAKOM/maxresdefault.jpg",
        "highlightlink": "https://youtu.be/No6OF0jAKOM",
        "fullreactionlink": "https://www.patreon.com/posts/star-wars-force-74782269",
        "tags": "['star wars', 'sci-fi', 'fantasy', 'adventure']",
        "uploaddate": 1669161600000
    },
    {
        "Name": "The Avengers",
        "Thumbnail src": "http://i3.ytimg.com/vi/x7M3pkgHL00/maxresdefault.jpg",
        "highlightlink": "https://youtu.be/x7M3pkgHL00",
        "fullreactionlink": "https://www.patreon.com/posts/avengers-full-74851853",
        "tags": "['mcu', 'marvel', 'sci-fi', 'action', 'super hero']",
        "uploaddate": 1669334400000
    },
    {
        "Name": "Star Wars Episode VIII: The Last Jedi",
        "Thumbnail src": "http://i3.ytimg.com/vi/JuceyBYk0Bw/maxresdefault.jpg",
        "highlightlink": "https://youtu.be/JuceyBYk0Bw",
        "fullreactionlink": "https://www.patreon.com/posts/star-wars-last-75035364",
        "tags": "['star wars', 'sci-fi', 'fantasy', 'adventure']",
        "uploaddate": 1669766400000
    },
    {
        "Name": "Iron Man 3",
        "Thumbnail src": "http://i3.ytimg.com/vi/JAU8aWWs41g/maxresdefault.jpg",
        "highlightlink": "https://youtu.be/JAU8aWWs41g",
        "fullreactionlink": "https://www.youtube.com/watch?v=_bllaphBz4k",
        "tags": "['mcu', 'marvel', 'sci-fi', 'action', 'super hero']",
        "uploaddate": 1670025600000
    },
    {
        "Name": "The Princess Bride",
        "Thumbnail src": "http://i3.ytimg.com/vi/beiwRdcR8Xg/maxresdefault.jpg",
        "highlightlink": "https://youtu.be/beiwRdcR8Xg",
        "fullreactionlink": "https://www.patreon.com/posts/princess-bride-75274418",
        "tags": "['adventure','classic', 'comedy', 'parody', 'inconceivable']",
        "uploaddate": 1670371200000
    },
    {
        "Name": "Star Wars Episode IX: The Rise of Skywalker",
        "Thumbnail src": "http://i3.ytimg.com/vi/NjvYPMCAg8Y/maxresdefault.jpg",
        "highlightlink": "https://youtu.be/NjvYPMCAg8Y",
        "fullreactionlink": "https://www.patreon.com/posts/star-wars-rise-75368930",
        "tags": "['star wars', 'sci-fi', 'fantasy', 'adventure']",
        "uploaddate": 1670457600000
    },
    {
        "Name": "Rogue One: A star Wars Story",
        "Thumbnail src": "http://i3.ytimg.com/vi/fn6Ql8Lvb2Q/maxresdefault.jpg",
        "highlightlink": "https://youtu.be/fn6Ql8Lvb2Q",
        "fullreactionlink": "https://www.patreon.com/posts/rogue-one-full-75639405",
        "tags": "['star wars', 'sci-fi', 'fantasy', 'adventure']",
        "uploaddate": 1670976000000
    },
    {
        "Name": "Cptain America: The Winter Soldier",
        "Thumbnail src": "http://i3.ytimg.com/vi/_a6ChDuItuA/maxresdefault.jpg",
        "highlightlink": "https://youtu.be/_a6ChDuItuA",
        "fullreactionlink": "https://www.patreon.com/posts/captain-america-75968547",
        "tags": "['mcu', 'marvel', 'sci-fi', 'action', 'super hero']",
        "uploaddate": 1671321600000
    },
    {
        "Name": "The Terminator",
        "Thumbnail src": "http://i3.ytimg.com/vi/cxDAhLqulZg/maxresdefault.jpg",
        "highlightlink": "https://youtu.be/cxDAhLqulZg",
        "fullreactionlink": "https://www.patreon.com/posts/terminator-full-75968598",
        "tags": "['action', 'sci-fi', 'dystopia', 'AI', 'classic']",
        "uploaddate": 1671667200000
    },
    {
        "Name": "Guardians of the Galaxy",
        "Thumbnail src": "http://i3.ytimg.com/vi/MDfoYgbsHV0/maxresdefault.jpg",
        "highlightlink": "https://youtu.be/MDfoYgbsHV0",
        "fullreactionlink": "https://www.patreon.com/posts/guardians-of-76315475",
        "tags": "['mcu', 'marvel', 'sci-fi', 'action', 'super hero']",
        "uploaddate": 1672358400000
    },
    {
        "Name": "Solo : A Star Wars Story",
        "Thumbnail src": "http://i3.ytimg.com/vi/EIfLxcLvADw/maxresdefault.jpg",
        "highlightlink": "https://youtu.be/EIfLxcLvADw",
        "fullreactionlink": "https://www.patreon.com/posts/solo-full-76315456",
        "tags": "['star wars', 'sci-fi', 'fantasy', 'adventure']",
        "uploaddate": 1672963200000
    },
    {
        "Name": "Terminator 2: Judgement Day",
        "Thumbnail src": "http://i3.ytimg.com/vi/3kMKk09jHoU/maxresdefault.jpg",
        "highlightlink": "https://youtu.be/3kMKk09jHoU",
        "fullreactionlink": "https://www.patreon.com/posts/terminator-2-day-76315488",
        "tags": "['action', 'sci-fi', 'dystopia', 'AI', 'classic']",
        "uploaddate": 1673308800000
    },
    {
        "Name": "Indiana Jones and The Raiders of the Lost Ark",
        "Thumbnail src": "http://i3.ytimg.com/vi/9jBHti5-GNM/maxresdefault.jpg",
        "highlightlink": "https://youtu.be/9jBHti5-GNM",
        "fullreactionlink": "https://www.patreon.com/posts/raiders-of-lost-77475289",
        "tags": "['adventure','classic']",
        "uploaddate": 1674086400000
    },
    {
        "Name": "Avengers: Age of Ultron",
        "Thumbnail src": "http://i3.ytimg.com/vi/4t62Lknta1s/maxresdefault.jpg",
        "highlightlink": "https://youtu.be/4t62Lknta1s",
        "fullreactionlink": "https://www.patreon.com/posts/age-of-ultron-93723256",
        "tags": "['mcu', 'marvel', 'sci-fi', 'action', 'super hero']",
        "uploaddate": 1675296000000
    },
    {
        "Name": "Commando",
        "Thumbnail src": "http://i3.ytimg.com/vi/nPShIwTuoUw/maxresdefault.jpg",
        "highlightlink": "https://youtu.be/nPShIwTuoUw",
        "fullreactionlink": "MISSING",
        "tags": "['action', 'classic']",
        "uploaddate": 1675987200000
    },
    {
        "Name": "Back to the Future",
        "Thumbnail src": "http://i3.ytimg.com/vi/kC0U4fC_D2E/maxresdefault.jpg",
        "highlightlink": "https://youtu.be/kC0U4fC_D2E",
        "fullreactionlink": "MISSING",
        "tags": "['adventure', 'sci-fi', 'time travel', 'classic']",
        "uploaddate": 1676592000000
    },
    {
        "Name": "Ocean's Eleven",
        "Thumbnail src": "https://i3.ytimg.com/vi/-NOLgD91wxU/maxresdefault.jpg",
        "highlightlink": "https://youtu.be/-NOLgD91wxU",
        "fullreactionlink": "https://www.patreon.com/posts/oceans-eleven-93126198",
        "tags": "['heist', 'action']",
        "uploaddate": 1700265600000
    },
    {
        "Name": "Captain America: Civil War",
        "Thumbnail src": "https://i3.ytimg.com/vi/vxCRhGaxrO0/maxresdefault.jpg",
        "highlightlink": "https://www.youtube.com/watch?v=vxCRhGaxrO0",
        "fullreactionlink": "https://www.patreon.com/posts/captain-america-93792545",
        "tags": "['heist', 'action', 'superher', 'marvel', 'mcu']",
        "uploaddate": 1701321600000
    },
    {
        "Name": "Back to the Future Part II",
        "Thumbnail src": "https://i3.ytimg.com/vi/OlOtpLSHVPk/maxresdefault.jpg",
        "highlightlink": "https://www.youtube.com/watch?v=OlOtpLSHVPk",
        "fullreactionlink": "https://www.patreon.com/posts/back-to-part-2-93969869",
        "tags": "['scifi', 'adventure']",
        "uploaddate": 1702669957000
    },
    {
        "Name": "The Martian",
        "Thumbnail src": "https://i3.ytimg.com/vi/7Sq_JTTQirE/maxresdefault.jpg",
        "highlightlink": "https://www.youtube.com/watch?v=7Sq_JTTQirE",
        "fullreactionlink": "https://www.patreon.com/posts/martian-full-94846952",
        "tags": "['scifi', 'adventure']",
        "uploaddate": 1703188357000
    },
    {
        "Name": "Doctor Strange",
        "Thumbnail src": "https://i3.ytimg.com/vi/_cpWwoDrKEk/maxresdefault.jpg",
        "highlightlink": "https://www.youtube.com/watch?v=_cpWwoDrKEk",
        "fullreactionlink": "https://www.patreon.com/posts/doctor-strange-95189962",
        "tags": "['scifi', 'superhero']",
        "uploaddate": 1706817157000
    },
    {
        "Name": "Jurassic Park",
        "Thumbnail src": "https://i3.ytimg.com/vi/LFiNLEId7HE/maxresdefault.jpg",
        "highlightlink": "https://www.youtube.com/watch?v=LFiNLEId7HE",
        "fullreactionlink": "https://www.patreon.com/posts/jurassic-park-112122527",
        "tags": "['scifi', 'adventure']",
        "uploaddate": 1726426357000
    },
    {
        "Name": "COMING SOON",
        "Thumbnail src": "-", 
        "highlightlink": "-",
        "fullreactionlink": "https://www.patreon.com/posts/daredevil-season-77838704",
        "tags": "['marvel', 'netflix', 'superhero', 'tv show']",
        "uploaddate": 1674777600000,
        "type": "tv show" 
    },
    {
        "Name": "COMING SOON",
        "Thumbnail src": "-",
        "highlightlink": "-",
        "fullreactionlink": "https://www.patreon.com/posts/daredevil-season-78691657",
        "tags": "['marvel', 'netflix', 'superhero', 'tv show']",
        "uploaddate": 1676505600000,
        "type": "tv show"
    },
    {
        "Name": "Temp",
        "Thumbnail src": "https://i3.ytimg.com/vi/jAy6NJ_D5vU/maxresdefault.jpg",
        "highlightlink": "https://youtu.be/jAy6NJ_D5vU", 
        "fullreactionlink": "https://www.patreon.com/posts/daredevil-season-77838704", 
        "tags": "['marvel', 'netflix', 'superhero', 'tv show']",
        "uploaddate": 1674777600000,
        "type": "episode",
        "season": "Seasonname"
    }
  
];


const createTile = (tile) => {
    if (tile.type === "tv show") {
        return `
            <div class="tile">
                <div class="thumbnail-container">
                    <img src="${tile['Thumbnail src']}" alt="${tile['Name']}" class="thumbnail">
                    <a href="#" class="all-episodes-link" data-season="${tile['Name']}">All Episodes</a> 
                </div>
                <div class="tile-info">
                    <h4>${tile['Name']}</h4>
                </div>
            </div>
        `;
    } else { // For movies and episodes
        return `
            <div class="tile">
                <div class="thumbnail-container">
                    <img src="${tile['Thumbnail src']}" alt="${tile['Name']}" class="thumbnail">
                    <a href="${tile['highlightlink']}" class="highlight-link">Reaction</a>
                    <a href="${tile['fullreactionlink']}" class="full-reaction-link">Full Length</a>
                </div>
                <div class="tile-info">
                    <h4>${tile['Name']}</h4>
                </div>
            </div>
        `;
    }
}

const populateTiles = (data) => {
    const tilesContainer = document.querySelector('.tiles-container');
    tilesContainer.innerHTML = data.map(createTile).join('');
}

const searchTiles = () => {
    const searchValue = document.getElementById('search-bar').value.toLowerCase();

    if (isShowingTVShows) {
        const tvShows = tilesData.filter(tile => tile.type === "tv show");
        const filteredTiles = tvShows.filter(tile =>
            tile['Name'].toLowerCase().includes(searchValue) ||
            tile['tags'].toLowerCase().includes(searchValue)
        );
        populateTiles(filteredTiles);
    } else if (isShowingEpisodes) {
        // Filter by currentSeason FIRST, then search within those episodes
        const currentSeasonEpisodes = tilesData.filter(tile => tile.type === "episode" && tile.season === currentSeason); 
        const filteredTiles = currentSeasonEpisodes.filter(tile =>
            tile['Name'].toLowerCase().includes(searchValue) ||
            tile['tags'].toLowerCase().includes(searchValue)
        );
        populateTiles(filteredTiles);
    } else { // Movies grid
        const movies = tilesData.filter(tile => !tile.type || tile.type === "movie");
        const filteredTiles = movies.filter(tile =>
            tile['Name'].toLowerCase().includes(searchValue) ||
            tile['tags'].toLowerCase().includes(searchValue)
        );
        populateTiles(filteredTiles);
    }
};

document.getElementById('search-bar').addEventListener('input', searchTiles);

const btnNewest = document.getElementById('sort-newest');
const btnOldest = document.getElementById('sort-oldest');
const btnTVShows = document.getElementById('show-tv-shows');

let isShowingTVShows = false;
let isShowingEpisodes = false;
let currentSeason = null;

const sortNewest = () => {
    const currentTiles = isShowingTVShows ? tilesData.filter(tile => tile.type === "tv show") : tilesData.filter(tile => !tile.type || tile.type === "movie");
    const sortedTiles = [...currentTiles].sort((a, b) => new Date(b['uploaddate']) - new Date(a['uploaddate']));
    populateTiles(sortedTiles);
    btnNewest.classList.add('active');
    btnOldest.classList.remove('active');
};

const sortOldest = () => {
    const currentTiles = isShowingTVShows ? tilesData.filter(tile => tile.type === "tv show") : tilesData.filter(tile => !tile.type || tile.type === "movie");
    const sortedTiles = [...currentTiles].sort((a, b) => new Date(a['uploaddate']) - new Date(b['uploaddate']));
    populateTiles(sortedTiles);
    btnOldest.classList.add('active');
    btnNewest.classList.remove('active');
};

const toggleTVShows = () => {
    if (isShowingEpisodes) { // If currently showing episodes (inside a season)
        isShowingEpisodes = false;
        isShowingTVShows = true; // Go back to showing the TV show grid
        btnTVShows.textContent = "Movies"; // Change button text back to "Movies"
        const tvShows = tilesData.filter(tile => tile.type === "tv show");
        populateTiles(tvShows);
    } else { // If currently showing movies or TV shows grid
        isShowingTVShows = !isShowingTVShows; 

        if (isShowingTVShows) {
            btnTVShows.textContent = "Movies";
            btnTVShows.classList.add('active');
            const tvShows = tilesData.filter(tile => tile.type === "tv show");
            populateTiles(tvShows);
        } else {
            btnTVShows.textContent = "TV Shows";
            btnTVShows.classList.remove('active');
            const movies = tilesData.filter(tile => !tile.type || tile.type === "movie");
            populateTiles(movies);
        }
    }
};

sortNewest();

btnNewest.addEventListener('click', sortNewest);
btnOldest.addEventListener('click', sortOldest);
btnTVShows.addEventListener('click', toggleTVShows);

document.addEventListener('click', (event) => {
    if (event.target.classList.contains('all-episodes-link')) {
        const seasonName = event.target.dataset.season;
        const episodes = tilesData.filter(tile => tile.type === "episode" && tile.season === seasonName);
        populateTiles(episodes);
        btnTVShows.textContent = "Back";
        isShowingEpisodes = true;
        currentSeason = seasonName; // Update currentSeason when "All Episodes" is clicked
    }
});